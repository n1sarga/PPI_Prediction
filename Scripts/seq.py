# -*- coding: utf-8 -*-
"""SEQ.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Rerq0UZnSkqMquS75Ea5BejqXT-sZdRY
"""

import pandas as pd
import requests
import csv

def fetch_protein_sequence(uniprot_id):
    url = f"https://www.uniprot.org/uniprot/{uniprot_id}.fasta" # Uniport API
    response = requests.get(url)
    if response.ok:
        # Ignore the garbage section
        lines = response.text.strip().split('\n')
        if lines[0].startswith('>'):
            sequence = ''.join(lines[1:])
        else:
            sequence = ''.join(lines)
        return sequence
    else:
        print(f"Failed to fetch sequence for UniProt ID: {uniprot_id}")
        return None

def read_csv(file_path):
    data = []
    with open(file_path, 'r') as csv_file:
        csv_reader = csv.reader(csv_file)
        for row in csv_reader:
            data.append(row)
    return data

def main(file_path):
    data = read_csv(file_path)
    sequences = []
    for row in data:
        pid_a, pseq_a, pid_b, pseq_b, interaction = row
        sequence_a = fetch_protein_sequence(pid_a)
        sequence_b = fetch_protein_sequence(pid_b)
        if sequence_a and sequence_b:
            sequences.append({
                'Identifier A': pid_a,
                'Protein Sequence A': sequence_a.strip() if pseq_a == '' else pseq_a.strip(),
                'Identifier B': pid_b,
                'Protein Sequence B': sequence_b.strip() if pseq_b == '' else pseq_b.strip(),
                'Interaction': interaction
            })

    df = pd.DataFrame(sequences)

    output_excel_file = 'output.csv'
    df.to_csv(output_excel_file, index=False)
    print(f"Sequences with interaction data saved to {output_excel_file}")

file_path = 'Maize_129.csv'
main(file_path)

from google.colab import files
files.download('output.csv')